# Basic Pentesting

> *Una receta para encontrar vulnerabilidades, contada como si estuvi√©ramos cocinando un pachamanca: aromas, pasos, condimentos y ‚Äîal final‚Äî el bocado que nos llena de emoci√≥n. pero si quieres tener ladocumentacion te la dejo aqui*

<p align="left">
  <a href='report-basicpentester.pdf'>
    <img width="50%" src="assets/report-basicpentester-tryhackme_page-0001.jpg" alt="Report Basic Pentester" />
  </a>
</p>

---

## üßë‚Äçüç≥ Introducci√≥n (Entrada caliente)

‚ÄúBasic Pentesting: TryHackMe‚Äù escrito por **kana**. Guia una pr√°ctica de pentesting en TryHackMe que cubre: enumeraci√≥n, explotaci√≥n y escalada de privilegios ‚Äîcon herramientas cl√°sicas‚Äî para completar un CTF did√°ctico.

## ü•£ Ingredientes principales (Herramientas y conceptos)

En nuestra cocina de seguridad utilizamos las siguientes ‚Äúespecias‚Äù y utensilios fundamentales:

* **Nmap** ‚Äî para olfatear puertos y servicios.
* **Nikto**, **Gobuster** ‚Äî para raspar y buscar directorios/archivos en servidores web.
* **enum4linux**, **smbclient** ‚Äî para olfatear y leer recursos SMB.
* **Nmap NSE / ssh-brute** o **Hydra** ‚Äî para ataques de fuerza bruta sobre SSH.
* **LinEnum / LinPeas** ‚Äî para automatizar la b√∫squeda de vectores de escalada en Linux.
* **scp**, **ssh**, **John the Ripper** ‚Äî para mover archivos, autenticarnos y quebrar claves cifradas.
  Estos elementos aparecen en el writeup como los pasos y herramientas clave para avanzar en el reto.

---

## üî• Preparaci√≥n paso a paso (La receta)

Imagina que est√°s en una cocina: cada fase del pentest es como preparar una parte del plato.

### 1. Mise en place ‚Äî Despliegue y escaneo

* Se despliega la m√°quina objetivo en TryHackMe y se lanza un escaneo Nmap para ver puertos abiertos. El autor encontr√≥ m√∫ltiples puertos abiertos (seis en su ejemplo), lo que ya nos da una buena base para seguir husmeando.

*A continuaci√≥n se muestran capturas del escaneo Nmap y resultados iniciales.*

> En la imagen se ve haciendo un `nmap` para todos los puertos abiertos y nos muestarn el puerto 22 y 80.
![Escaneo nmap - captura 1](assets/image.png)
![Escaneo nmap - captura 2](assets/image-1.png)
![Escaneo nmap - captura 3](assets/image-2.png)

---

### 2. Degustaci√≥n del front-end ‚Äî Enumeraci√≥n HTTP

* Abrimos la web y, al inspeccionar la fuente, hay una pista: un comentario que apunta a una secci√≥n `dev` ‚Äî¬°una especia escondida!

*Capturas de la enumeraci√≥n web y descubrimiento de `/development/`.*

> Aqui vemos la enumeraci√≥n con `nikto` y resultados
![Enumeracion nikto - captura 4](assets/image-3.png)

> Aqui vemos la enumeraci√≥n con `gobuster` integrando dos variables `TARGET_IP` con la ip de la victima y `wordlist` con la ruta de script 
![Enumeracion gobuster - captura 5](assets/image-4.png)


* Se usa **Nikto** para escanear el servidor web y **Gobuster** para descubrir directorios. Ambos devolvieron rutas interesantes, entre ellas `/development/`, que ocultaba archivos con informaci√≥n jugosa. 

**Hallazgo clave:** `/development/` (archivo `dev.txt` y `j.txt`) ‚Äî contiene una conversaci√≥n y pistas sobre usuarios y contrase√±as.

> Aqui se ve la paginas econtradas por `nikto` y `gobuster` 
![Pagina 1](assets/image-15.png)
![Pagina 1](assets/image-19.png)


> se encontro en la ruta `/development` los archivos `dev.txt` y `j.txt` 
![Pagina 2](assets/image-16.png)

> revisamos ocntenido de archivo `dev.txt`
![Pagina 3](assets/image-17.png)

> y obviamente del archivo `j.txt`
![Pagina 4](assets/image-18.png)

---

### 3. Hurgando en la despensa ‚Äî SMB Enumeration

* Con **enum4linux** se descubre que existe una cuenta an√≥nima y un recurso compartido accesible. Ah√≠ se encontr√≥ un `staff.txt` con nombres completos: **Jan** y **Kay**, conectando las pistas del sitio web con usuarios del sistema.

*Capturas relacionadas con SMB y enum4linux/smbclient.*

> se ve el script utilizando `enum4linu` y resultados
![Enum4linux ‚Äî descubrimiento de SMB](assets/image-9.png)
![Enum4linux ‚Äî descubrimiento de SMB](assets/image-10.png)


Se econtro un archivo `Anonymous` eso se hara con la erramienta **smbcliente** a este archivo 

> se utiliza el smbcliente con el ruta `/Anonymous` y se lista los archivos encontrados que es `staff.txt`
![Acceso a recurso compartido SMB ‚Äî listado de archivos](assets/image-11.png)

> se ve el contenido del archivo `staff.txt` encontrado
![Contenido de staff.txt y pistas de usuarios](assets/imageimage-12.png)

---

### 4. El golpe maestro ‚Äî Explotaci√≥n (Brute-force SSH)

* Con la lista de usuarios (`jan`, `kay`) y una wordlist (ej. `rockyou.txt`), se emple√≥ el script NSE `ssh-brute` de Nmap (o alternativamente **Hydra**) para forzar credenciales SSH.
* Resultado: credenciales v√°lidas encontradas: **usuario** `Jan` con **contrase√±a** `Armando` (se accede por SSH). ¬°Bocado conseguido! 

*Capturas del intento de conexi√≥n SSH, resultado de brute-force y acceso.*

*Capturas de la enumeraci√≥n web y descubrimiento de `/development/`.*

> primero se hace la busque de de un script con la palabra `ssh` en la banca de nmap 
![Busqueda en nmap - captura 6](assets/image-5.png)

> se colo las variables o atributos que nos pide el scripts  
![Asignacion de atributos - captura 7](assets/image-6.png)

> se ve el script de un ataque de fuerza bruta con `nmap` con un script `ssh-brute` y algunos argumentos que nos pide
![Brute-force / intento SSH - logs y resultados](assets/image-7.png)

> resultado que encontro el `ssh-brute` 
![Brute Force - Log resultado](assets/image-9.png)

> realizamos un ingreso por `ssh` con el usuario `jan` y el password `armando` que encontramos
![login ssh](assets/image-13.png)
![login ssh 1](assets/image-14.png)

---

### 5. El postre ‚Äî Escalada de privilegios

* Una vez dentro como `jan`, se realiza una nueva enumeraci√≥n (manual y con LinEnum/LinPeas). Ah√≠ aparece algo muy sabroso: en el home de **kay** existe `.ssh/id_rsa` (clave privada) con permisos peligrosos.

Antes de eso utilizaremos un herramienta **Linenum** para subir privigeios

> clonamos el repositorio `LinEnum` 
![github clone](assets/image-20.png)

> hacemos un listener con `python3`
![pyhton3 - listener](assets/image-21.png)

> hacemos el `wget` enviando la herramienta clonada `LinEnum` subimos privilegios para ejecutarlo en la maquina 
![wget - envio de archivo](assets/image-22.png)

> ejecucion de `LinEnum`
![LinEnum](assets/image-23.png)

> resultados
![LinEnum 1](assets/image-24.png)

> al entrar el home de usuariio `kay` encontramos el archivo que buscamos `./ssh/id_rsa`
![Home kay](assets/image-25.png)


* Se copia la clave (`scp`) y, tras ajustar permisos, se descubre que la clave privada est√° protegida por una passphrase. Usando **John the Ripper** se quiebra la passphrase; con ello se logra el acceso a la cuenta `kay`. Desde `kay` (miembro de `sudo`), se obtiene la contrase√±a final/flag:
  `heresareallystrongpasswordthatfollowsthepasswordpolicy$$`.

*Capturas de la b√∫squeda de archivos sensibles, copia de `id_rsa`, cracking de passphrase y escalada final.*


> al entrar el home de usuariio `kay` encontramos el archivo que buscamos `./ssh/id_rsa`
![Home kay](assets/image-25.png)

> enviamos a la maquina atacante el `id_rsa`
![envio .ssh/id_rsa al maquina atacante](assets/image-27.png)

> ingresamos al usuario `kay` con el password del archivo `id_rsa` pero no nos deja por la clave de hash
![1er intendo de ssh de kay](assets/image-28.png)

> intentamos aumentando permisos de ejecucion y tampoco
![2er intendo de ssh de kay](assets/image-28.png)

> para eso hacemos un ataque JohnTheRipper e ingresamos con la contrase√±a que encontramos `beeswax` del susario `kay`
![John the Ripper ‚Äî cracking de passphrase (proceso)](assets/image-30.png)
![John the Ripper ‚Äî mostrando contrase√±a](assets/image-31.png)

>> Buscamos la clave y lo encontramos
![Acceso como kay y uso de sudo para obtener la flag/contrase√±a final](assets/image-33.png)
